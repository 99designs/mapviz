var sampleusers = [
{userid: 273295, attachmentid: 10813854, avatar: "http://99designs.com/users/273295/avatar/10813854/tinyzoom", latitude: 46.0553000, longitude: 14.5144000},
{userid: 498258, attachmentid: 6788854, avatar: "http://99designs.com/users/498258/avatar/6788854/tinyzoom", latitude: 52.4167000, longitude: 16.9667000},
{userid: 555454, attachmentid: 10922455, avatar: "http://99designs.com/users/555454/avatar/10922455/tinyzoom", latitude: -34.5875000, longitude: -58.6725000},
{userid: 589089, attachmentid: 9130158, avatar: "http://99designs.com/users/589089/avatar/9130158/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 508162, attachmentid: 10921689, avatar: "http://99designs.com/users/508162/avatar/10921689/tinyzoom", latitude: -6.1744000, longitude: 106.8294000},
{userid: 618723, attachmentid: 9615415, avatar: "http://99designs.com/users/618723/avatar/9615415/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 415247, attachmentid: 10684691, avatar: "http://99designs.com/users/415247/avatar/10684691/tinyzoom", latitude: 44.4333000, longitude: 26.1000000},
{userid: 514894, attachmentid: 10546761, avatar: "http://99designs.com/users/514894/avatar/10546761/tinyzoom", latitude: 44.8186000, longitude: 20.4681000},
{userid: 380564, attachmentid: 3725850, avatar: "http://99designs.com/users/380564/avatar/3725850/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 567082, attachmentid: 8567845, avatar: "http://99designs.com/users/567082/avatar/8567845/tinyzoom", latitude: 44.8186000, longitude: 20.4681000},
{userid: 330255, attachmentid: 10636269, avatar: "http://99designs.com/users/330255/avatar/10636269/tinyzoom", latitude: 42.0000000, longitude: 19.0000000},
{userid: 426879, attachmentid: 5258100, avatar: "http://99designs.com/users/426879/avatar/5258100/tinyzoom", latitude: 51.5002000, longitude: -0.1262000},
{userid: 586013, attachmentid: 9342082, avatar: "http://99designs.com/users/586013/avatar/9342082/tinyzoom", latitude: 22.5697000, longitude: 88.3697000},
{userid: 446618, attachmentid: 6763885, avatar: "http://99designs.com/users/446618/avatar/6763885/tinyzoom", latitude: 33.8004000, longitude: -84.3865000},
{userid: 557973, attachmentid: 9874496, avatar: "http://99designs.com/users/557973/avatar/9874496/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 533275, attachmentid: 7860867, avatar: "http://99designs.com/users/533275/avatar/7860867/tinyzoom", latitude: 41.1333000, longitude: 16.8500000},
{userid: 358033, attachmentid: 9385785, avatar: "http://99designs.com/users/358033/avatar/9385785/tinyzoom", latitude: 31.5497000, longitude: 74.3436000},
{userid: 340909, attachmentid: 2574096, avatar: "http://99designs.com/users/340909/avatar/2574096/tinyzoom", latitude: 28.6000000, longitude: 77.2000000},
{userid: 653208, attachmentid: 10380924, avatar: "http://99designs.com/users/653208/avatar/10380924/tinyzoom", latitude: 47.6667000, longitude: 23.5833000},
{userid: 644275, attachmentid: 10149320, avatar: "http://99designs.com/users/644275/avatar/10149320/tinyzoom", latitude: 42.4833000, longitude: 26.5000000},
{userid: 620964, attachmentid: 9674102, avatar: "http://99designs.com/users/620964/avatar/9674102/tinyzoom", latitude: 44.9320000, longitude: -93.4201000},
{userid: 557549, attachmentid: 10508324, avatar: "http://99designs.com/users/557549/avatar/10508324/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 557549, attachmentid: 10508324, avatar: "http://99designs.com/users/557549/avatar/10508324/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 447717, attachmentid: 5773831, avatar: "http://99designs.com/users/447717/avatar/5773831/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 252234, attachmentid: 2445785, avatar: "http://99designs.com/users/252234/avatar/2445785/tinyzoom", latitude: 53.5333000, longitude: -0.0500000},
{userid: 179148, attachmentid: 9410384, avatar: "http://99designs.com/users/179148/avatar/9410384/tinyzoom", latitude: 44.1833000, longitude: 28.6500000},
{userid: 639417, attachmentid: 10262157, avatar: "http://99designs.com/users/639417/avatar/10262157/tinyzoom", latitude: 14.6042000, longitude: 120.9822000},
{userid: 562433, attachmentid: 10565713, avatar: "http://99designs.com/users/562433/avatar/10565713/tinyzoom", latitude: 45.8000000, longitude: 16.0000000},
{userid: 552647, attachmentid: 10794365, avatar: "http://99designs.com/users/552647/avatar/10794365/tinyzoom", latitude: 28.6000000, longitude: 77.2000000},
{userid: 656888, attachmentid: 10750790, avatar: "http://99designs.com/users/656888/avatar/10750790/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 282176, attachmentid: 6712233, avatar: "http://99designs.com/users/282176/avatar/6712233/tinyzoom", latitude: 13.0000000, longitude: 122.0000000},
{userid: 483286, attachmentid: 10769182, avatar: "http://99designs.com/users/483286/avatar/10769182/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 511729, attachmentid: 7187992, avatar: "http://99designs.com/users/511729/avatar/7187992/tinyzoom", latitude: 44.8186000, longitude: 20.4681000},
{userid: 692105, attachmentid: 10906731, avatar: "http://99designs.com/users/692105/avatar/10906731/tinyzoom", latitude: 52.5333000, longitude: 5.7167000},
{userid: 300763, attachmentid: 1519005, avatar: "http://99designs.com/users/300763/avatar/1519005/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 544895, attachmentid: 7973199, avatar: "http://99designs.com/users/544895/avatar/7973199/tinyzoom", latitude: 24.8667000, longitude: 67.0500000},
{userid: 579262, attachmentid: 8935434, avatar: "http://99designs.com/users/579262/avatar/8935434/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 592154, attachmentid: 10931406, avatar: "http://99designs.com/users/592154/avatar/10931406/tinyzoom", latitude: -33.9167000, longitude: 18.4167000},
{userid: 455703, attachmentid: 5647292, avatar: "http://99designs.com/users/455703/avatar/5647292/tinyzoom", latitude: 35.8278000, longitude: -78.6421000},
{userid: 557844, attachmentid: 8485504, avatar: "http://99designs.com/users/557844/avatar/8485504/tinyzoom", latitude: -7.7828000, longitude: 110.3608000},
{userid: 557844, attachmentid: 8485504, avatar: "http://99designs.com/users/557844/avatar/8485504/tinyzoom", latitude: -7.7828000, longitude: 110.3608000},
{userid: 360718, attachmentid: 7188299, avatar: "http://99designs.com/users/360718/avatar/7188299/tinyzoom", latitude: 44.8186000, longitude: 20.4681000},
{userid: 692933, attachmentid: 10916975, avatar: "http://99designs.com/users/692933/avatar/10916975/tinyzoom", latitude: 43.6167000, longitude: 13.4000000},
{userid: 533093, attachmentid: 10497987, avatar: "http://99designs.com/users/533093/avatar/10497987/tinyzoom", latitude: 14.5667000, longitude: 121.0333000},
{userid: 561714, attachmentid: 8605774, avatar: "http://99designs.com/users/561714/avatar/8605774/tinyzoom", latitude: -5.0000000, longitude: 120.0000000},
{userid: 652074, attachmentid: 10270274, avatar: "http://99designs.com/users/652074/avatar/10270274/tinyzoom", latitude: 12.9833000, longitude: 77.5833000},
{userid: 455703, attachmentid: 5647292, avatar: "http://99designs.com/users/455703/avatar/5647292/tinyzoom", latitude: 35.8278000, longitude: -78.6421000},
{userid: 607867, attachmentid: 9343253, avatar: "http://99designs.com/users/607867/avatar/9343253/tinyzoom", latitude: -6.1744000, longitude: 106.8294000},
];

var socket = io.connect();
socket.on('event', function (data) {
	console.log(JSON.parse(data));
});


var template =
	'<div class="marker">'+
	'  <div class="inner">'+
	'    <div class="shadow"></div>'+
	'    <div class="bounce">'+
	'     <div class="glow"></div>'+
	'     <div class="mask">'+
	'       <div class="content"></div>'+
	'     </div>'+
	'    </div>'
	'  </div>'+
	'</div>';

$(function() {
	interval = window.setInterval(function() {

		var i =Math.floor(Math.random() * sampleusers.length);
		var user = sampleusers[i];
		// user.latitude *= -1;

		var e = $(Mustache.to_html(template, {}));
		e.css({
			top: latitudeAsPercent(user.latitude)+'%',
			left: longtitudeAsPercent(user.longitude)+'%'
		});

		console.log([user.latitude, user.longitude, latitudeAsPercent(user.latitude), longtitudeAsPercent(user.longitude)]);

		var img = new Image();
		img.onload = function(){
			$('.map').append(e);
			e.addClass('visible');
			window.setTimeout(function() {
				e.addClass('disappearing');
			}, 2000);
			window.setTimeout(function() {
				e.remove();
			}, 3000);
		};
		img.src = user.avatar;
		// console.log(img.src);
		e.find('.content').append(img);
	}, 500);
});


// --

var latitudeAsPercent = function(lat) {
	return ((lat + 90) / 180) * 100;
};

var longtitudeAsPercent = function(long) {
	return ((long + 180) / 360) * 100;
};

